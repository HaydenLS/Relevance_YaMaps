# Project Overview

Репозиторий содержит эксперименты по классификации пользовательских запросов относительно организаций на картах с использованием базовой модели и LLM-агентов.  
Решение построено в три этапа: baseline-модель, LLM-агент и многошаговый агент с веб-поиском.

Основной результат проекта — реализация многошаговой агентной системы, способной принимать решение о релевантности организации к запросу пользователя с учетом данных и дополнительной информации из интернета.

---

# Структура проекта

## notebooks/

Содержит этапы разработки решения:

1. `1_baseline.ipynb` — базовая трансформер-модель  
2. `2_llm_agent.ipynb` — LLM-классификация  
3. `3_agent.ipynb` — прототип многошагового агента  

Финальная версия агента вынесена в модуль `org_relevance`.

---

## org_relevance/

Основной модуль проекта.

Содержит:

- Архитектуру агента на основе графа  
- Router-узел для принятия решения о необходимости веб-поиска  
- Web search-узел  
- Финальный классификатор  
- Ограничение количества веб-попыток  
- Логику остановки при достижении лимита  
- Подсчет метрик качества  

Агент реализует динамическую маршрутизацию: при достаточной локальной информации решение принимается сразу, при неопределенности выполняется веб-поиск.

---

## streamlit_app/

Интерфейс для интерактивной работы с агентом.

Позволяет:

- Выбрать LLM-провайдера и модель  
- Настроить параметры запуска  
- Запуск обработки отдельных примеров  
- Запуск батчевой обработки   
- Получть подробные метрики качества  

---


# Инструкции по запуску

## 1. Настройка конфигурации

Перед запуском необходимо открыть файл:

Base Config/basic_config.json

и указать ключи доступа:

{
  "debug": true,
  "keys": [
    {"name": "OPENROUTER_API_KEY", "key": ""},
    {"name": "OPENAI_API_KEY", "key": ""},
    {"name": "OLLAMA_API_KEY", "key": ""},
    {"name": "HF_TOKEN", "key": ""}
  ]
}

Требования:

- HF_TOKEN обязателен  
- Необходим любой LLM-провайдер: OpenAI или OpenRouter или свой собственный
- OLLAMA_API_KEY требуется только при использовании Ollama  

**Переименуйте файл в config.json**

---

## 2. Установка зависимостей

poetry install

---

## 3. Запуск приложения

poetry run streamlit run streamlit_app/app.py

После запуска откроется веб-интерфейс для работы с системой.

---

# Результаты

В рамках проекта:

- Реализована полноценная агентная архитектура  
- Внедрена динамическая маршрутизация  
- Добавлен управляемый веб-поиск c retrival по страницам.
- Реализована защита от бесконечных попыток обращения к API  
- Обеспечен расчет метрик и контроль качества  

"""